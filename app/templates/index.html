{% extends 'base.html' %} {% block head %}
<link
  rel="stylesheet"
  href="{{url_for('static', filename='/styles/home/home.css')}}"
/>
<title>Suspense</title>
{% endblock %} {% block body %} {% if loggedIn == True %}

<main id="dashboard">
  <div class="flex-box-sa">
    <p>
      <span id="money-left"
        >${{ (user_data.monthly_income + user_cash) - (total_monthly_expenses +
        auto_deductions) }}</span
      >
      <br />remaing
    </p>
    <p><span>{{ days_until_first }} days</span> <br />remaining</p>
  </div>
  
  <div class='flex-box-sa'>
    <div class='flex-box-col-sa-wrap'>
      <p>Categories:</p>
      {% for num in range( relevant_tag_colors | length )%}
      <p><span class="tag-color-square" data-color="{{relevant_tag_colors[num]}}"></span>{{relevant_tag_names[num]}}</p>
      {% endfor %}
    </div>
    <canvas id="pieChart" width="300" height="300"></canvas>
  </div>
  <script>
    const ctx = document.getElementById('pieChart').getContext('2d')
    const pieChart = new Chart(ctx, {
      type: 'pie', 
      data: {
        
        datasets: [
          {
            data: {{ values | safe }},
            backgroundColor: {{ relevant_tag_colors | safe}},
            borderWidth: 0
          }
        ]
      },
      options: {
        responsive: false,
        tooltips: {
          enabled: true,
          callbacks: {
              label: function(tooltipItem, data) {
                const item = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];
                return item
              }
          } 
        }
      }
  });
  </script>


  {% for data in activity_data %}
  <a href="#" class="edit-activity-btn" id="activity{{n}}">
    {% if data|length > 4 %}
    <div class="flex-box-sa" data-type="expense">
    {% else%}
    <div class="flex-box-sa" data-type="deposit">
    {% endif %}
        <div class='flex-box-col-se date-div'
        data-current-date="{{data[0].strftime('%Y')}}-{{data[0].strftime('%m')}}-{{data[0].strftime('%d')}}">
        <p>{{ data[0].strftime('%b') }} {{ data[0].day }}</p>
        <p>{{ data[0].year}}</p>
      </div>
      <div class="flex-box-col-sa">
        {% if data|length > 4 %}
        <p
          data-product-id="{{data[5]}}"
          data-tag-id="{{data[4]}}"
        >
          {{ data[3] }}
        </p>
        {% else%}
        <p data-cash-id="{{data[3]}}">Deposit</p>
        {% endif %}
        <p>{{ data[2] }}</p>
      </div>
      <p>${{ data[1] }}</p>
    </div>
  </a>
  {% endfor%} 
  {% else %}
  <main id="home-page">
    <h1>Suspend</h1>
    <p>"take the suspense out of expenses"</p>
    <img
      src="https://cdn.educba.com/academy/wp-content/uploads/2019/07/pie-chart-examples.png"
      alt="screenshot of graph"
    />
    <a href="{{ url_for('site.signup')}}"><button>Signup</button></a>
    <a href="{{ url_for('site.login')}}"><button>Login</button></a>
  </main>
  {% endif%} {% endblock %}
</main>
